{
  "name": "code-completion",
  "version": 0.1,
  "imports": [
    "https://get.silverbullet.md/global.plug.json"
  ],
  "functions": {
    "fullPageCodeCompletion": {
      "command": {
        "name": "OpenAI: Full Page Code Completion"
      },
      "code": "(() => { var mod=(()=>{var b=Object.create;var a=Object.defineProperty;var N=Object.getOwnPropertyDescriptor;var A=Object.getOwnPropertyNames;var M=Object.getPrototypeOf,R=Object.prototype.hasOwnProperty;var k=(e=>typeof require!=\"undefined\"?require:typeof Proxy!=\"undefined\"?new Proxy(e,{get:(t,r)=>(typeof require!=\"undefined\"?require:t)[r]}):e)(function(e){if(typeof require!=\"undefined\")return require.apply(this,arguments);throw new Error('Dynamic require of \"'+e+'\" is not supported')});var c=(e,t)=>{for(var r in t)a(e,r,{get:t[r],enumerable:!0})},w=(e,t,r,n)=>{if(t&&typeof t==\"object\"||typeof t==\"function\")for(let i of A(t))!R.call(e,i)&&i!==r&&a(e,i,{get:()=>t[i],enumerable:!(n=N(t,i))||n.enumerable});return e};var q=(e,t,r)=>(r=e!=null?b(M(e)):{},w(t||!e||!e.__esModule?a(r,\"default\",{value:e,enumerable:!0}):r,e)),E=e=>w(a({},\"__esModule\",{value:!0}),e);var we={};c(we,{default:()=>ye});typeof self>\"u\"&&(self={syscall:()=>{throw new Error(\"Not implemented here\")}});var o=self.syscall;var s={};c(s,{dispatch:()=>_,enableReadOnlyMode:()=>te,filterBox:()=>D,flashNotification:()=>J,getCurrentPage:()=>G,getCursor:()=>j,getSelection:()=>$,getText:()=>I,hidePanel:()=>U,insertAtCursor:()=>X,insertAtPos:()=>V,matchBefore:()=>Z,moveCursor:()=>W,navigate:()=>Y,openUrl:()=>z,prompt:()=>ee,reloadPage:()=>F,replaceRange:()=>H,save:()=>L,setPage:()=>K,setSelection:()=>B,showPanel:()=>Q});function G(){return o(\"editor.getCurrentPage\")}function K(e){return o(\"editor.setPage\",e)}function I(){return o(\"editor.getText\")}function j(){return o(\"editor.getCursor\")}function $(){return o(\"editor.getSelection\")}function B(e,t){return o(\"editor.setSelection\",e,t)}function L(){return o(\"editor.save\")}function Y(e,t,r=!1){return o(\"editor.navigate\",e,t,r)}function F(){return o(\"editor.reloadPage\")}function z(e){return o(\"editor.openUrl\",e)}function J(e,t=\"info\"){return o(\"editor.flashNotification\",e,t)}function D(e,t,r=\"\",n=\"\"){return o(\"editor.filterBox\",e,t,r,n)}function Q(e,t,r,n=\"\"){return o(\"editor.showPanel\",e,t,r,n)}function U(e){return o(\"editor.hidePanel\",e)}function V(e,t){return o(\"editor.insertAtPos\",e,t)}function H(e,t,r){return o(\"editor.replaceRange\",e,t,r)}function W(e){return o(\"editor.moveCursor\",e)}function X(e){return o(\"editor.insertAtCursor\",e)}function Z(e){return o(\"editor.matchBefore\",e)}function _(e){return o(\"editor.dispatch\",e)}function ee(e,t=\"\"){return o(\"editor.prompt\",e,t)}function te(e){return o(\"editor.enableReadOnlyMode\",e)}var l={};c(l,{parseMarkdown:()=>re});function re(e){return o(\"markdown.parseMarkdown\",e)}var p={};c(p,{deleteAttachment:()=>ge,deletePage:()=>le,getAttachmentMeta:()=>fe,getPageMeta:()=>se,listAttachments:()=>me,listPages:()=>ie,listPlugs:()=>pe,readAttachment:()=>ue,readPage:()=>ae,writeAttachment:()=>de,writePage:()=>ce});function ie(e=!1){return o(\"space.listPages\",e)}function se(e){return o(\"space.getPageMeta\",e)}function ae(e){return o(\"space.readPage\",e)}function ce(e,t){return o(\"space.writePage\",e,t)}function le(e){return o(\"space.deletePage\",e)}function pe(){return o(\"space.listPlugs\")}function me(){return o(\"space.listAttachments\")}function fe(e){return o(\"space.getAttachmentMeta\",e)}function ue(e){return o(\"space.readAttachment\",e)}function de(e,t,r){return o(\"space.writeAttachment\",e,t,r)}function ge(e){return o(\"space.deleteAttachment\",e)}function d(e,t){if(t(e))return[e];let r=[];if(e.children)for(let n of e.children)r=[...r,...d(n,t)];return r}function g(e,t){return d(e,r=>r.type===t)[0]}function T(e,t){d(e,t)}var P=q(k(\"https://deno.land/std/encoding/yaml.ts\"));async function m(e,t=[\"yaml\"]){let r=await p.readPage(e),n=await l.parseMarkdown(r),i={};return T(n,u=>{if(u.type!==\"FencedCode\")return!1;let h=g(u,\"CodeInfo\");if(!h||!t.includes(h.children[0].text))return!1;let x=g(u,\"CodeText\");if(!x)return!1;let S=x.children[0].text;try{i=P.parse(S)}catch(y){throw console.error(\"YAML Page parser error\",y),new Error(`YAML Error: ${y.message}`)}return!0}),i}async function v(e){try{let t=await m(\"SECRETS\",[\"yaml\",\"secrets\"]),r=[];for(let n of e){let i=t[n];if(i)r.push(i);else throw new Error(`No such secret: ${n}`)}return r}catch(t){throw t.message===\"Page not found\"?new Error(`No such secret: ${e[0]}`):t}}var f=class{constructor(t){this.apiKey=t}async createCompletion(t){return(await fetch(\"https://api.openai.com/v1/completions\",{method:\"POST\",headers:{\"Content-Type\":\"application/json\",Authorization:`Bearer ${this.apiKey}`},body:JSON.stringify(t)})).json()}async createEdit(t){return(await fetch(\"https://api.openai.com/v1/edits\",{method:\"POST\",headers:{\"Content-Type\":\"application/json\",Authorization:`Bearer ${this.apiKey}`},body:JSON.stringify(t)})).json()}async createImage(t){return(await fetch(\"https://api.openai.com/v1/images/generations\",{method:\"POST\",headers:{\"Content-Type\":\"application/json\",Authorization:`Bearer ${this.apiKey}`},body:JSON.stringify(t)})).json()}async createModeration(t){return(await fetch(\"https://api.openai.com/v1/moderations\",{method:\"POST\",headers:{\"Content-Type\":\"application/json\",Authorization:`Bearer ${this.apiKey}`},body:JSON.stringify(t)})).json()}async getModels(){return(await fetch(\"https://api.openai.com/v1/models\",{method:\"GET\",headers:{\"Content-Type\":\"application/json\",Authorization:`Bearer ${this.apiKey}`}})).json()}};async function he(){try{let[e]=await v([\"openai\"]);return e}catch{console.error(\"No openai token found\"),s.flashNotification(\"SECRETS page missing, or OpenAI API token not configured correctly.\",\"error\")}}async function xe(){try{return await m(\"openai/settings\")}catch(e){return console.log(e),s.flashNotification(\"Settings page missing, or settings not configured correctly.\",\"error\"),[]}}async function C(){let e=await xe(),t=await s.getText();e.codeCompletion.prompt=t,console.log(e.codeCompletion);try{let r=await he(),n=new f(r);s.flashNotification(\"Generating completion...\",\"info\");let i=await n.createCompletion(e.codeCompletion);s.insertAtCursor(i.choices[0].text)}catch(r){console.log(r),s.flashNotification(\"Something went wrong\",\"error\")}s.flashNotification(\"Generation complete\",\"info\")}var ye=C;return E(we);})();\n return mod;})()"
    },
    "selectionCodeCompletion": {
      "command": {
        "name": "OpenAI: Selection Code Completion"
      },
      "code": "(() => { var mod=(()=>{var b=Object.create;var l=Object.defineProperty;var N=Object.getOwnPropertyDescriptor;var A=Object.getOwnPropertyNames;var M=Object.getPrototypeOf,R=Object.prototype.hasOwnProperty;var k=(e=>typeof require!=\"undefined\"?require:typeof Proxy!=\"undefined\"?new Proxy(e,{get:(t,r)=>(typeof require!=\"undefined\"?require:t)[r]}):e)(function(e){if(typeof require!=\"undefined\")return require.apply(this,arguments);throw new Error('Dynamic require of \"'+e+'\" is not supported')});var p=(e,t)=>{for(var r in t)l(e,r,{get:t[r],enumerable:!0})},w=(e,t,r,n)=>{if(t&&typeof t==\"object\"||typeof t==\"function\")for(let i of A(t))!R.call(e,i)&&i!==r&&l(e,i,{get:()=>t[i],enumerable:!(n=N(t,i))||n.enumerable});return e};var q=(e,t,r)=>(r=e!=null?b(M(e)):{},w(t||!e||!e.__esModule?l(r,\"default\",{value:e,enumerable:!0}):r,e)),E=e=>w(l({},\"__esModule\",{value:!0}),e);var we={};p(we,{default:()=>ye});typeof self>\"u\"&&(self={syscall:()=>{throw new Error(\"Not implemented here\")}});var o=self.syscall;var s={};p(s,{dispatch:()=>_,enableReadOnlyMode:()=>te,filterBox:()=>D,flashNotification:()=>J,getCurrentPage:()=>G,getCursor:()=>j,getSelection:()=>$,getText:()=>I,hidePanel:()=>U,insertAtCursor:()=>X,insertAtPos:()=>V,matchBefore:()=>Z,moveCursor:()=>W,navigate:()=>Y,openUrl:()=>z,prompt:()=>ee,reloadPage:()=>F,replaceRange:()=>H,save:()=>L,setPage:()=>K,setSelection:()=>B,showPanel:()=>Q});function G(){return o(\"editor.getCurrentPage\")}function K(e){return o(\"editor.setPage\",e)}function I(){return o(\"editor.getText\")}function j(){return o(\"editor.getCursor\")}function $(){return o(\"editor.getSelection\")}function B(e,t){return o(\"editor.setSelection\",e,t)}function L(){return o(\"editor.save\")}function Y(e,t,r=!1){return o(\"editor.navigate\",e,t,r)}function F(){return o(\"editor.reloadPage\")}function z(e){return o(\"editor.openUrl\",e)}function J(e,t=\"info\"){return o(\"editor.flashNotification\",e,t)}function D(e,t,r=\"\",n=\"\"){return o(\"editor.filterBox\",e,t,r,n)}function Q(e,t,r,n=\"\"){return o(\"editor.showPanel\",e,t,r,n)}function U(e){return o(\"editor.hidePanel\",e)}function V(e,t){return o(\"editor.insertAtPos\",e,t)}function H(e,t,r){return o(\"editor.replaceRange\",e,t,r)}function W(e){return o(\"editor.moveCursor\",e)}function X(e){return o(\"editor.insertAtCursor\",e)}function Z(e){return o(\"editor.matchBefore\",e)}function _(e){return o(\"editor.dispatch\",e)}function ee(e,t=\"\"){return o(\"editor.prompt\",e,t)}function te(e){return o(\"editor.enableReadOnlyMode\",e)}var m={};p(m,{parseMarkdown:()=>re});function re(e){return o(\"markdown.parseMarkdown\",e)}var f={};p(f,{deleteAttachment:()=>ge,deletePage:()=>le,getAttachmentMeta:()=>fe,getPageMeta:()=>se,listAttachments:()=>me,listPages:()=>ie,listPlugs:()=>pe,readAttachment:()=>ue,readPage:()=>ae,writeAttachment:()=>de,writePage:()=>ce});function ie(e=!1){return o(\"space.listPages\",e)}function se(e){return o(\"space.getPageMeta\",e)}function ae(e){return o(\"space.readPage\",e)}function ce(e,t){return o(\"space.writePage\",e,t)}function le(e){return o(\"space.deletePage\",e)}function pe(){return o(\"space.listPlugs\")}function me(){return o(\"space.listAttachments\")}function fe(e){return o(\"space.getAttachmentMeta\",e)}function ue(e){return o(\"space.readAttachment\",e)}function de(e,t,r){return o(\"space.writeAttachment\",e,t,r)}function ge(e){return o(\"space.deleteAttachment\",e)}function g(e,t){if(t(e))return[e];let r=[];if(e.children)for(let n of e.children)r=[...r,...g(n,t)];return r}function P(e,t){return g(e,r=>r.type===t)[0]}function T(e,t){g(e,t)}var h=q(k(\"https://deno.land/std/encoding/yaml.ts\"));async function u(e,t=[\"yaml\"]){let r=await f.readPage(e),n=await m.parseMarkdown(r),i={};return T(n,a=>{if(a.type!==\"FencedCode\")return!1;let c=P(a,\"CodeInfo\");if(!c||!t.includes(c.children[0].text))return!1;let x=P(a,\"CodeText\");if(!x)return!1;let S=x.children[0].text;try{i=h.parse(S)}catch(y){throw console.error(\"YAML Page parser error\",y),new Error(`YAML Error: ${y.message}`)}return!0}),i}async function v(e){try{let t=await u(\"SECRETS\",[\"yaml\",\"secrets\"]),r=[];for(let n of e){let i=t[n];if(i)r.push(i);else throw new Error(`No such secret: ${n}`)}return r}catch(t){throw t.message===\"Page not found\"?new Error(`No such secret: ${e[0]}`):t}}var d=class{constructor(t){this.apiKey=t}async createCompletion(t){return(await fetch(\"https://api.openai.com/v1/completions\",{method:\"POST\",headers:{\"Content-Type\":\"application/json\",Authorization:`Bearer ${this.apiKey}`},body:JSON.stringify(t)})).json()}async createEdit(t){return(await fetch(\"https://api.openai.com/v1/edits\",{method:\"POST\",headers:{\"Content-Type\":\"application/json\",Authorization:`Bearer ${this.apiKey}`},body:JSON.stringify(t)})).json()}async createImage(t){return(await fetch(\"https://api.openai.com/v1/images/generations\",{method:\"POST\",headers:{\"Content-Type\":\"application/json\",Authorization:`Bearer ${this.apiKey}`},body:JSON.stringify(t)})).json()}async createModeration(t){return(await fetch(\"https://api.openai.com/v1/moderations\",{method:\"POST\",headers:{\"Content-Type\":\"application/json\",Authorization:`Bearer ${this.apiKey}`},body:JSON.stringify(t)})).json()}async getModels(){return(await fetch(\"https://api.openai.com/v1/models\",{method:\"GET\",headers:{\"Content-Type\":\"application/json\",Authorization:`Bearer ${this.apiKey}`}})).json()}};async function he(){try{let[e]=await v([\"openai\"]);return e}catch{console.error(\"No openai token found\"),s.flashNotification(\"SECRETS page missing, or OpenAI API token not configured correctly.\",\"error\")}}async function xe(){try{return await u(\"openai/settings\")}catch(e){return console.log(e),s.flashNotification(\"Settings page missing, or settings not configured correctly.\",\"error\"),[]}}async function C(){let e=await s.getText(),t=await s.getSelection(),r=e.slice(t.from,t.to),n=await xe();n.codeCompletion.prompt=r,console.log(n.codeCompletion);try{let i=await he(),a=new d(i);s.flashNotification(\"Generating completion...\",\"info\");let c=await a.createCompletion(n.codeCompletion);s.insertAtPos(c.choices[0].text,t.to)}catch(i){console.log(i),s.flashNotification(\"Something went wrong\",\"error\")}s.flashNotification(\"Generation complete\",\"info\")}var ye=C;return E(we);})();\n return mod;})()"
    },
    "readSettings": {
      "command": {
        "name": "OpenAI: Settings"
      },
      "code": "(() => { var mod=(()=>{var C=Object.create;var s=Object.defineProperty;var S=Object.getOwnPropertyDescriptor;var b=Object.getOwnPropertyNames;var N=Object.getPrototypeOf,A=Object.prototype.hasOwnProperty;var M=(e=>typeof require!=\"undefined\"?require:typeof Proxy!=\"undefined\"?new Proxy(e,{get:(t,r)=>(typeof require!=\"undefined\"?require:t)[r]}):e)(function(e){if(typeof require!=\"undefined\")return require.apply(this,arguments);throw new Error('Dynamic require of \"'+e+'\" is not supported')});var a=(e,t)=>{for(var r in t)s(e,r,{get:t[r],enumerable:!0})},y=(e,t,r,n)=>{if(t&&typeof t==\"object\"||typeof t==\"function\")for(let i of b(t))!A.call(e,i)&&i!==r&&s(e,i,{get:()=>t[i],enumerable:!(n=S(t,i))||n.enumerable});return e};var R=(e,t,r)=>(r=e!=null?C(N(e)):{},y(t||!e||!e.__esModule?s(r,\"default\",{value:e,enumerable:!0}):r,e)),k=e=>y(s({},\"__esModule\",{value:!0}),e);var Pe={};a(Pe,{default:()=>ge});typeof self>\"u\"&&(self={syscall:()=>{throw new Error(\"Not implemented here\")}});var o=self.syscall;var c={};a(c,{dispatch:()=>X,enableReadOnlyMode:()=>_,filterBox:()=>z,flashNotification:()=>F,getCurrentPage:()=>E,getCursor:()=>K,getSelection:()=>I,getText:()=>G,hidePanel:()=>D,insertAtCursor:()=>H,insertAtPos:()=>Q,matchBefore:()=>W,moveCursor:()=>V,navigate:()=>B,openUrl:()=>Y,prompt:()=>Z,reloadPage:()=>L,replaceRange:()=>U,save:()=>$,setPage:()=>O,setSelection:()=>j,showPanel:()=>J});function E(){return o(\"editor.getCurrentPage\")}function O(e){return o(\"editor.setPage\",e)}function G(){return o(\"editor.getText\")}function K(){return o(\"editor.getCursor\")}function I(){return o(\"editor.getSelection\")}function j(e,t){return o(\"editor.setSelection\",e,t)}function $(){return o(\"editor.save\")}function B(e,t,r=!1){return o(\"editor.navigate\",e,t,r)}function L(){return o(\"editor.reloadPage\")}function Y(e){return o(\"editor.openUrl\",e)}function F(e,t=\"info\"){return o(\"editor.flashNotification\",e,t)}function z(e,t,r=\"\",n=\"\"){return o(\"editor.filterBox\",e,t,r,n)}function J(e,t,r,n=\"\"){return o(\"editor.showPanel\",e,t,r,n)}function D(e){return o(\"editor.hidePanel\",e)}function Q(e,t){return o(\"editor.insertAtPos\",e,t)}function U(e,t,r){return o(\"editor.replaceRange\",e,t,r)}function V(e){return o(\"editor.moveCursor\",e)}function H(e){return o(\"editor.insertAtCursor\",e)}function W(e){return o(\"editor.matchBefore\",e)}function X(e){return o(\"editor.dispatch\",e)}function Z(e,t=\"\"){return o(\"editor.prompt\",e,t)}function _(e){return o(\"editor.enableReadOnlyMode\",e)}var l={};a(l,{parseMarkdown:()=>te});function te(e){return o(\"markdown.parseMarkdown\",e)}var p={};a(p,{deleteAttachment:()=>ue,deletePage:()=>ae,getAttachmentMeta:()=>pe,getPageMeta:()=>ne,listAttachments:()=>le,listPages:()=>re,listPlugs:()=>ce,readAttachment:()=>me,readPage:()=>ie,writeAttachment:()=>fe,writePage:()=>se});function re(e=!1){return o(\"space.listPages\",e)}function ne(e){return o(\"space.getPageMeta\",e)}function ie(e){return o(\"space.readPage\",e)}function se(e,t){return o(\"space.writePage\",e,t)}function ae(e){return o(\"space.deletePage\",e)}function ce(){return o(\"space.listPlugs\")}function le(){return o(\"space.listAttachments\")}function pe(e){return o(\"space.getAttachmentMeta\",e)}function me(e){return o(\"space.readAttachment\",e)}function fe(e,t,r){return o(\"space.writeAttachment\",e,t,r)}function ue(e){return o(\"space.deleteAttachment\",e)}function f(e,t){if(t(e))return[e];let r=[];if(e.children)for(let n of e.children)r=[...r,...f(n,t)];return r}function u(e,t){return f(e,r=>r.type===t)[0]}function w(e,t){f(e,t)}var d=R(M(\"https://deno.land/std/encoding/yaml.ts\"));async function g(e,t=[\"yaml\"]){let r=await p.readPage(e),n=await l.parseMarkdown(r),i={};return w(n,m=>{if(m.type!==\"FencedCode\")return!1;let P=u(m,\"CodeInfo\");if(!P||!t.includes(P.children[0].text))return!1;let h=u(m,\"CodeText\");if(!h)return!1;let v=h.children[0].text;try{i=d.parse(v)}catch(x){throw console.error(\"YAML Page parser error\",x),new Error(`YAML Error: ${x.message}`)}return!0}),i}async function T(){try{return await g(\"openai/settings\")}catch(e){return console.log(e),c.flashNotification(\"Settings page missing, or settings not configured correctly.\",\"error\"),[]}}var ge=T;return k(Pe);})();\n return mod;})()"
    },
    "fullPageCompletion": {
      "command": {
        "name": "OpenAI: Full Page Completion"
      },
      "code": "(() => { var mod=(()=>{var b=Object.create;var a=Object.defineProperty;var N=Object.getOwnPropertyDescriptor;var A=Object.getOwnPropertyNames;var M=Object.getPrototypeOf,R=Object.prototype.hasOwnProperty;var k=(e=>typeof require!=\"undefined\"?require:typeof Proxy!=\"undefined\"?new Proxy(e,{get:(t,r)=>(typeof require!=\"undefined\"?require:t)[r]}):e)(function(e){if(typeof require!=\"undefined\")return require.apply(this,arguments);throw new Error('Dynamic require of \"'+e+'\" is not supported')});var c=(e,t)=>{for(var r in t)a(e,r,{get:t[r],enumerable:!0})},w=(e,t,r,n)=>{if(t&&typeof t==\"object\"||typeof t==\"function\")for(let i of A(t))!R.call(e,i)&&i!==r&&a(e,i,{get:()=>t[i],enumerable:!(n=N(t,i))||n.enumerable});return e};var q=(e,t,r)=>(r=e!=null?b(M(e)):{},w(t||!e||!e.__esModule?a(r,\"default\",{value:e,enumerable:!0}):r,e)),E=e=>w(a({},\"__esModule\",{value:!0}),e);var we={};c(we,{default:()=>ye});typeof self>\"u\"&&(self={syscall:()=>{throw new Error(\"Not implemented here\")}});var o=self.syscall;var s={};c(s,{dispatch:()=>_,enableReadOnlyMode:()=>te,filterBox:()=>D,flashNotification:()=>J,getCurrentPage:()=>G,getCursor:()=>j,getSelection:()=>$,getText:()=>I,hidePanel:()=>U,insertAtCursor:()=>X,insertAtPos:()=>V,matchBefore:()=>Z,moveCursor:()=>W,navigate:()=>Y,openUrl:()=>z,prompt:()=>ee,reloadPage:()=>F,replaceRange:()=>H,save:()=>L,setPage:()=>K,setSelection:()=>B,showPanel:()=>Q});function G(){return o(\"editor.getCurrentPage\")}function K(e){return o(\"editor.setPage\",e)}function I(){return o(\"editor.getText\")}function j(){return o(\"editor.getCursor\")}function $(){return o(\"editor.getSelection\")}function B(e,t){return o(\"editor.setSelection\",e,t)}function L(){return o(\"editor.save\")}function Y(e,t,r=!1){return o(\"editor.navigate\",e,t,r)}function F(){return o(\"editor.reloadPage\")}function z(e){return o(\"editor.openUrl\",e)}function J(e,t=\"info\"){return o(\"editor.flashNotification\",e,t)}function D(e,t,r=\"\",n=\"\"){return o(\"editor.filterBox\",e,t,r,n)}function Q(e,t,r,n=\"\"){return o(\"editor.showPanel\",e,t,r,n)}function U(e){return o(\"editor.hidePanel\",e)}function V(e,t){return o(\"editor.insertAtPos\",e,t)}function H(e,t,r){return o(\"editor.replaceRange\",e,t,r)}function W(e){return o(\"editor.moveCursor\",e)}function X(e){return o(\"editor.insertAtCursor\",e)}function Z(e){return o(\"editor.matchBefore\",e)}function _(e){return o(\"editor.dispatch\",e)}function ee(e,t=\"\"){return o(\"editor.prompt\",e,t)}function te(e){return o(\"editor.enableReadOnlyMode\",e)}var l={};c(l,{parseMarkdown:()=>re});function re(e){return o(\"markdown.parseMarkdown\",e)}var p={};c(p,{deleteAttachment:()=>ge,deletePage:()=>le,getAttachmentMeta:()=>fe,getPageMeta:()=>se,listAttachments:()=>me,listPages:()=>ie,listPlugs:()=>pe,readAttachment:()=>ue,readPage:()=>ae,writeAttachment:()=>de,writePage:()=>ce});function ie(e=!1){return o(\"space.listPages\",e)}function se(e){return o(\"space.getPageMeta\",e)}function ae(e){return o(\"space.readPage\",e)}function ce(e,t){return o(\"space.writePage\",e,t)}function le(e){return o(\"space.deletePage\",e)}function pe(){return o(\"space.listPlugs\")}function me(){return o(\"space.listAttachments\")}function fe(e){return o(\"space.getAttachmentMeta\",e)}function ue(e){return o(\"space.readAttachment\",e)}function de(e,t,r){return o(\"space.writeAttachment\",e,t,r)}function ge(e){return o(\"space.deleteAttachment\",e)}function d(e,t){if(t(e))return[e];let r=[];if(e.children)for(let n of e.children)r=[...r,...d(n,t)];return r}function g(e,t){return d(e,r=>r.type===t)[0]}function T(e,t){d(e,t)}var P=q(k(\"https://deno.land/std/encoding/yaml.ts\"));async function m(e,t=[\"yaml\"]){let r=await p.readPage(e),n=await l.parseMarkdown(r),i={};return T(n,u=>{if(u.type!==\"FencedCode\")return!1;let h=g(u,\"CodeInfo\");if(!h||!t.includes(h.children[0].text))return!1;let x=g(u,\"CodeText\");if(!x)return!1;let S=x.children[0].text;try{i=P.parse(S)}catch(y){throw console.error(\"YAML Page parser error\",y),new Error(`YAML Error: ${y.message}`)}return!0}),i}async function v(e){try{let t=await m(\"SECRETS\",[\"yaml\",\"secrets\"]),r=[];for(let n of e){let i=t[n];if(i)r.push(i);else throw new Error(`No such secret: ${n}`)}return r}catch(t){throw t.message===\"Page not found\"?new Error(`No such secret: ${e[0]}`):t}}var f=class{constructor(t){this.apiKey=t}async createCompletion(t){return(await fetch(\"https://api.openai.com/v1/completions\",{method:\"POST\",headers:{\"Content-Type\":\"application/json\",Authorization:`Bearer ${this.apiKey}`},body:JSON.stringify(t)})).json()}async createEdit(t){return(await fetch(\"https://api.openai.com/v1/edits\",{method:\"POST\",headers:{\"Content-Type\":\"application/json\",Authorization:`Bearer ${this.apiKey}`},body:JSON.stringify(t)})).json()}async createImage(t){return(await fetch(\"https://api.openai.com/v1/images/generations\",{method:\"POST\",headers:{\"Content-Type\":\"application/json\",Authorization:`Bearer ${this.apiKey}`},body:JSON.stringify(t)})).json()}async createModeration(t){return(await fetch(\"https://api.openai.com/v1/moderations\",{method:\"POST\",headers:{\"Content-Type\":\"application/json\",Authorization:`Bearer ${this.apiKey}`},body:JSON.stringify(t)})).json()}async getModels(){return(await fetch(\"https://api.openai.com/v1/models\",{method:\"GET\",headers:{\"Content-Type\":\"application/json\",Authorization:`Bearer ${this.apiKey}`}})).json()}};async function he(){try{let[e]=await v([\"openai\"]);return e}catch{console.error(\"No openai token found\"),s.flashNotification(\"SECRETS page missing, or OpenAI API token not configured correctly.\",\"error\")}}async function xe(){try{return await m(\"openai/settings\")}catch(e){return console.log(e),s.flashNotification(\"Settings page missing, or settings not configured correctly.\",\"error\"),[]}}async function C(){let e=await xe(),t=await s.getText();e.completion.prompt=t,console.log(e.completion);try{let r=await he(),n=new f(r);s.flashNotification(\"Generating completion...\",\"info\");let i=await n.createCompletion(e.completion);s.insertAtCursor(i.choices[0].text)}catch(r){console.log(r),s.flashNotification(\"Something went wrong\",\"error\")}s.flashNotification(\"Generation complete\",\"info\")}var ye=C;return E(we);})();\n return mod;})()"
    },
    "selectionCompletion": {
      "command": {
        "name": "OpenAI: Selection Completion"
      },
      "code": "(() => { var mod=(()=>{var b=Object.create;var l=Object.defineProperty;var N=Object.getOwnPropertyDescriptor;var A=Object.getOwnPropertyNames;var M=Object.getPrototypeOf,R=Object.prototype.hasOwnProperty;var k=(e=>typeof require!=\"undefined\"?require:typeof Proxy!=\"undefined\"?new Proxy(e,{get:(t,r)=>(typeof require!=\"undefined\"?require:t)[r]}):e)(function(e){if(typeof require!=\"undefined\")return require.apply(this,arguments);throw new Error('Dynamic require of \"'+e+'\" is not supported')});var p=(e,t)=>{for(var r in t)l(e,r,{get:t[r],enumerable:!0})},w=(e,t,r,n)=>{if(t&&typeof t==\"object\"||typeof t==\"function\")for(let i of A(t))!R.call(e,i)&&i!==r&&l(e,i,{get:()=>t[i],enumerable:!(n=N(t,i))||n.enumerable});return e};var q=(e,t,r)=>(r=e!=null?b(M(e)):{},w(t||!e||!e.__esModule?l(r,\"default\",{value:e,enumerable:!0}):r,e)),E=e=>w(l({},\"__esModule\",{value:!0}),e);var we={};p(we,{default:()=>ye});typeof self>\"u\"&&(self={syscall:()=>{throw new Error(\"Not implemented here\")}});var o=self.syscall;var s={};p(s,{dispatch:()=>_,enableReadOnlyMode:()=>te,filterBox:()=>D,flashNotification:()=>J,getCurrentPage:()=>G,getCursor:()=>j,getSelection:()=>$,getText:()=>I,hidePanel:()=>U,insertAtCursor:()=>X,insertAtPos:()=>V,matchBefore:()=>Z,moveCursor:()=>W,navigate:()=>Y,openUrl:()=>z,prompt:()=>ee,reloadPage:()=>F,replaceRange:()=>H,save:()=>L,setPage:()=>K,setSelection:()=>B,showPanel:()=>Q});function G(){return o(\"editor.getCurrentPage\")}function K(e){return o(\"editor.setPage\",e)}function I(){return o(\"editor.getText\")}function j(){return o(\"editor.getCursor\")}function $(){return o(\"editor.getSelection\")}function B(e,t){return o(\"editor.setSelection\",e,t)}function L(){return o(\"editor.save\")}function Y(e,t,r=!1){return o(\"editor.navigate\",e,t,r)}function F(){return o(\"editor.reloadPage\")}function z(e){return o(\"editor.openUrl\",e)}function J(e,t=\"info\"){return o(\"editor.flashNotification\",e,t)}function D(e,t,r=\"\",n=\"\"){return o(\"editor.filterBox\",e,t,r,n)}function Q(e,t,r,n=\"\"){return o(\"editor.showPanel\",e,t,r,n)}function U(e){return o(\"editor.hidePanel\",e)}function V(e,t){return o(\"editor.insertAtPos\",e,t)}function H(e,t,r){return o(\"editor.replaceRange\",e,t,r)}function W(e){return o(\"editor.moveCursor\",e)}function X(e){return o(\"editor.insertAtCursor\",e)}function Z(e){return o(\"editor.matchBefore\",e)}function _(e){return o(\"editor.dispatch\",e)}function ee(e,t=\"\"){return o(\"editor.prompt\",e,t)}function te(e){return o(\"editor.enableReadOnlyMode\",e)}var m={};p(m,{parseMarkdown:()=>re});function re(e){return o(\"markdown.parseMarkdown\",e)}var f={};p(f,{deleteAttachment:()=>ge,deletePage:()=>le,getAttachmentMeta:()=>fe,getPageMeta:()=>se,listAttachments:()=>me,listPages:()=>ie,listPlugs:()=>pe,readAttachment:()=>ue,readPage:()=>ae,writeAttachment:()=>de,writePage:()=>ce});function ie(e=!1){return o(\"space.listPages\",e)}function se(e){return o(\"space.getPageMeta\",e)}function ae(e){return o(\"space.readPage\",e)}function ce(e,t){return o(\"space.writePage\",e,t)}function le(e){return o(\"space.deletePage\",e)}function pe(){return o(\"space.listPlugs\")}function me(){return o(\"space.listAttachments\")}function fe(e){return o(\"space.getAttachmentMeta\",e)}function ue(e){return o(\"space.readAttachment\",e)}function de(e,t,r){return o(\"space.writeAttachment\",e,t,r)}function ge(e){return o(\"space.deleteAttachment\",e)}function g(e,t){if(t(e))return[e];let r=[];if(e.children)for(let n of e.children)r=[...r,...g(n,t)];return r}function P(e,t){return g(e,r=>r.type===t)[0]}function T(e,t){g(e,t)}var h=q(k(\"https://deno.land/std/encoding/yaml.ts\"));async function u(e,t=[\"yaml\"]){let r=await f.readPage(e),n=await m.parseMarkdown(r),i={};return T(n,a=>{if(a.type!==\"FencedCode\")return!1;let c=P(a,\"CodeInfo\");if(!c||!t.includes(c.children[0].text))return!1;let x=P(a,\"CodeText\");if(!x)return!1;let S=x.children[0].text;try{i=h.parse(S)}catch(y){throw console.error(\"YAML Page parser error\",y),new Error(`YAML Error: ${y.message}`)}return!0}),i}async function v(e){try{let t=await u(\"SECRETS\",[\"yaml\",\"secrets\"]),r=[];for(let n of e){let i=t[n];if(i)r.push(i);else throw new Error(`No such secret: ${n}`)}return r}catch(t){throw t.message===\"Page not found\"?new Error(`No such secret: ${e[0]}`):t}}var d=class{constructor(t){this.apiKey=t}async createCompletion(t){return(await fetch(\"https://api.openai.com/v1/completions\",{method:\"POST\",headers:{\"Content-Type\":\"application/json\",Authorization:`Bearer ${this.apiKey}`},body:JSON.stringify(t)})).json()}async createEdit(t){return(await fetch(\"https://api.openai.com/v1/edits\",{method:\"POST\",headers:{\"Content-Type\":\"application/json\",Authorization:`Bearer ${this.apiKey}`},body:JSON.stringify(t)})).json()}async createImage(t){return(await fetch(\"https://api.openai.com/v1/images/generations\",{method:\"POST\",headers:{\"Content-Type\":\"application/json\",Authorization:`Bearer ${this.apiKey}`},body:JSON.stringify(t)})).json()}async createModeration(t){return(await fetch(\"https://api.openai.com/v1/moderations\",{method:\"POST\",headers:{\"Content-Type\":\"application/json\",Authorization:`Bearer ${this.apiKey}`},body:JSON.stringify(t)})).json()}async getModels(){return(await fetch(\"https://api.openai.com/v1/models\",{method:\"GET\",headers:{\"Content-Type\":\"application/json\",Authorization:`Bearer ${this.apiKey}`}})).json()}};async function he(){try{let[e]=await v([\"openai\"]);return e}catch{console.error(\"No openai token found\"),s.flashNotification(\"SECRETS page missing, or OpenAI API token not configured correctly.\",\"error\")}}async function xe(){try{return await u(\"openai/settings\")}catch(e){return console.log(e),s.flashNotification(\"Settings page missing, or settings not configured correctly.\",\"error\"),[]}}async function C(){let e=await s.getText(),t=await s.getSelection(),r=e.slice(t.from,t.to),n=await xe();n.completion.prompt=r,console.log(n.completion);try{let i=await he(),a=new d(i);s.flashNotification(\"Generating completion...\",\"info\");let c=await a.createCompletion(n.completion);s.insertAtPos(c.choices[0].text,t.to)}catch(i){console.log(i),s.flashNotification(\"Something went wrong\",\"error\")}s.flashNotification(\"Generation complete\",\"info\")}var ye=C;return E(we);})();\n return mod;})()"
    },
    "imageGeneration": {
      "command": {
        "name": "OpenAI: Image Generation"
      },
      "code": "(() => { var mod=(()=>{var b=Object.create;var l=Object.defineProperty;var N=Object.getOwnPropertyDescriptor;var A=Object.getOwnPropertyNames;var M=Object.getPrototypeOf,R=Object.prototype.hasOwnProperty;var k=(e=>typeof require!=\"undefined\"?require:typeof Proxy!=\"undefined\"?new Proxy(e,{get:(t,r)=>(typeof require!=\"undefined\"?require:t)[r]}):e)(function(e){if(typeof require!=\"undefined\")return require.apply(this,arguments);throw new Error('Dynamic require of \"'+e+'\" is not supported')});var p=(e,t)=>{for(var r in t)l(e,r,{get:t[r],enumerable:!0})},w=(e,t,r,n)=>{if(t&&typeof t==\"object\"||typeof t==\"function\")for(let i of A(t))!R.call(e,i)&&i!==r&&l(e,i,{get:()=>t[i],enumerable:!(n=N(t,i))||n.enumerable});return e};var q=(e,t,r)=>(r=e!=null?b(M(e)):{},w(t||!e||!e.__esModule?l(r,\"default\",{value:e,enumerable:!0}):r,e)),E=e=>w(l({},\"__esModule\",{value:!0}),e);var we={};p(we,{default:()=>ye});typeof self>\"u\"&&(self={syscall:()=>{throw new Error(\"Not implemented here\")}});var o=self.syscall;var s={};p(s,{dispatch:()=>_,enableReadOnlyMode:()=>te,filterBox:()=>D,flashNotification:()=>J,getCurrentPage:()=>O,getCursor:()=>j,getSelection:()=>$,getText:()=>I,hidePanel:()=>U,insertAtCursor:()=>X,insertAtPos:()=>V,matchBefore:()=>Z,moveCursor:()=>W,navigate:()=>Y,openUrl:()=>z,prompt:()=>ee,reloadPage:()=>F,replaceRange:()=>H,save:()=>L,setPage:()=>K,setSelection:()=>B,showPanel:()=>Q});function O(){return o(\"editor.getCurrentPage\")}function K(e){return o(\"editor.setPage\",e)}function I(){return o(\"editor.getText\")}function j(){return o(\"editor.getCursor\")}function $(){return o(\"editor.getSelection\")}function B(e,t){return o(\"editor.setSelection\",e,t)}function L(){return o(\"editor.save\")}function Y(e,t,r=!1){return o(\"editor.navigate\",e,t,r)}function F(){return o(\"editor.reloadPage\")}function z(e){return o(\"editor.openUrl\",e)}function J(e,t=\"info\"){return o(\"editor.flashNotification\",e,t)}function D(e,t,r=\"\",n=\"\"){return o(\"editor.filterBox\",e,t,r,n)}function Q(e,t,r,n=\"\"){return o(\"editor.showPanel\",e,t,r,n)}function U(e){return o(\"editor.hidePanel\",e)}function V(e,t){return o(\"editor.insertAtPos\",e,t)}function H(e,t,r){return o(\"editor.replaceRange\",e,t,r)}function W(e){return o(\"editor.moveCursor\",e)}function X(e){return o(\"editor.insertAtCursor\",e)}function Z(e){return o(\"editor.matchBefore\",e)}function _(e){return o(\"editor.dispatch\",e)}function ee(e,t=\"\"){return o(\"editor.prompt\",e,t)}function te(e){return o(\"editor.enableReadOnlyMode\",e)}var m={};p(m,{parseMarkdown:()=>re});function re(e){return o(\"markdown.parseMarkdown\",e)}var f={};p(f,{deleteAttachment:()=>ge,deletePage:()=>le,getAttachmentMeta:()=>fe,getPageMeta:()=>se,listAttachments:()=>me,listPages:()=>ie,listPlugs:()=>pe,readAttachment:()=>ue,readPage:()=>ae,writeAttachment:()=>de,writePage:()=>ce});function ie(e=!1){return o(\"space.listPages\",e)}function se(e){return o(\"space.getPageMeta\",e)}function ae(e){return o(\"space.readPage\",e)}function ce(e,t){return o(\"space.writePage\",e,t)}function le(e){return o(\"space.deletePage\",e)}function pe(){return o(\"space.listPlugs\")}function me(){return o(\"space.listAttachments\")}function fe(e){return o(\"space.getAttachmentMeta\",e)}function ue(e){return o(\"space.readAttachment\",e)}function de(e,t,r){return o(\"space.writeAttachment\",e,t,r)}function ge(e){return o(\"space.deleteAttachment\",e)}function g(e,t){if(t(e))return[e];let r=[];if(e.children)for(let n of e.children)r=[...r,...g(n,t)];return r}function P(e,t){return g(e,r=>r.type===t)[0]}function T(e,t){g(e,t)}var h=q(k(\"https://deno.land/std/encoding/yaml.ts\"));async function u(e,t=[\"yaml\"]){let r=await f.readPage(e),n=await m.parseMarkdown(r),i={};return T(n,a=>{if(a.type!==\"FencedCode\")return!1;let c=P(a,\"CodeInfo\");if(!c||!t.includes(c.children[0].text))return!1;let x=P(a,\"CodeText\");if(!x)return!1;let S=x.children[0].text;try{i=h.parse(S)}catch(y){throw console.error(\"YAML Page parser error\",y),new Error(`YAML Error: ${y.message}`)}return!0}),i}async function v(e){try{let t=await u(\"SECRETS\",[\"yaml\",\"secrets\"]),r=[];for(let n of e){let i=t[n];if(i)r.push(i);else throw new Error(`No such secret: ${n}`)}return r}catch(t){throw t.message===\"Page not found\"?new Error(`No such secret: ${e[0]}`):t}}var d=class{constructor(t){this.apiKey=t}async createCompletion(t){return(await fetch(\"https://api.openai.com/v1/completions\",{method:\"POST\",headers:{\"Content-Type\":\"application/json\",Authorization:`Bearer ${this.apiKey}`},body:JSON.stringify(t)})).json()}async createEdit(t){return(await fetch(\"https://api.openai.com/v1/edits\",{method:\"POST\",headers:{\"Content-Type\":\"application/json\",Authorization:`Bearer ${this.apiKey}`},body:JSON.stringify(t)})).json()}async createImage(t){return(await fetch(\"https://api.openai.com/v1/images/generations\",{method:\"POST\",headers:{\"Content-Type\":\"application/json\",Authorization:`Bearer ${this.apiKey}`},body:JSON.stringify(t)})).json()}async createModeration(t){return(await fetch(\"https://api.openai.com/v1/moderations\",{method:\"POST\",headers:{\"Content-Type\":\"application/json\",Authorization:`Bearer ${this.apiKey}`},body:JSON.stringify(t)})).json()}async getModels(){return(await fetch(\"https://api.openai.com/v1/models\",{method:\"GET\",headers:{\"Content-Type\":\"application/json\",Authorization:`Bearer ${this.apiKey}`}})).json()}};async function he(){try{let[e]=await v([\"openai\"]);return e}catch{console.error(\"No openai token found\"),s.flashNotification(\"SECRETS page missing, or OpenAI API token not configured correctly.\",\"error\")}}async function xe(){try{return await u(\"openai/settings\")}catch(e){return console.log(e),s.flashNotification(\"Settings page missing, or settings not configured correctly.\",\"error\"),[]}}async function C(){let e=await xe(),t=await s.getText(),r=await s.getSelection(),n=t.slice(r.from,r.to);e.imageGeneration.prompt=n,console.log(e.imageGeneration),s.flashNotification(\"Generating image...\",\"info\");try{let i=await he(),c=await new d(i).createImage(e.imageGeneration);s.insertAtPos(`![${n}](${c.data[0].url})`,r.to)}catch(i){console.log(i),s.flashNotification(\"Something went wrong\",\"error\")}s.flashNotification(\"Generation complete\",\"info\")}var ye=C;return E(we);})();\n return mod;})()"
    },
    "editSelection": {
      "command": {
        "name": "OpenAI: Edit Selection"
      },
      "code": "(() => { var mod=(()=>{var b=Object.create;var l=Object.defineProperty;var N=Object.getOwnPropertyDescriptor;var A=Object.getOwnPropertyNames;var M=Object.getPrototypeOf,R=Object.prototype.hasOwnProperty;var k=(e=>typeof require!=\"undefined\"?require:typeof Proxy!=\"undefined\"?new Proxy(e,{get:(t,r)=>(typeof require!=\"undefined\"?require:t)[r]}):e)(function(e){if(typeof require!=\"undefined\")return require.apply(this,arguments);throw new Error('Dynamic require of \"'+e+'\" is not supported')});var p=(e,t)=>{for(var r in t)l(e,r,{get:t[r],enumerable:!0})},w=(e,t,r,n)=>{if(t&&typeof t==\"object\"||typeof t==\"function\")for(let i of A(t))!R.call(e,i)&&i!==r&&l(e,i,{get:()=>t[i],enumerable:!(n=N(t,i))||n.enumerable});return e};var q=(e,t,r)=>(r=e!=null?b(M(e)):{},w(t||!e||!e.__esModule?l(r,\"default\",{value:e,enumerable:!0}):r,e)),E=e=>w(l({},\"__esModule\",{value:!0}),e);var we={};p(we,{default:()=>ye});typeof self>\"u\"&&(self={syscall:()=>{throw new Error(\"Not implemented here\")}});var o=self.syscall;var s={};p(s,{dispatch:()=>_,enableReadOnlyMode:()=>te,filterBox:()=>D,flashNotification:()=>J,getCurrentPage:()=>G,getCursor:()=>j,getSelection:()=>$,getText:()=>I,hidePanel:()=>U,insertAtCursor:()=>X,insertAtPos:()=>V,matchBefore:()=>Z,moveCursor:()=>W,navigate:()=>Y,openUrl:()=>z,prompt:()=>ee,reloadPage:()=>F,replaceRange:()=>H,save:()=>L,setPage:()=>K,setSelection:()=>B,showPanel:()=>Q});function G(){return o(\"editor.getCurrentPage\")}function K(e){return o(\"editor.setPage\",e)}function I(){return o(\"editor.getText\")}function j(){return o(\"editor.getCursor\")}function $(){return o(\"editor.getSelection\")}function B(e,t){return o(\"editor.setSelection\",e,t)}function L(){return o(\"editor.save\")}function Y(e,t,r=!1){return o(\"editor.navigate\",e,t,r)}function F(){return o(\"editor.reloadPage\")}function z(e){return o(\"editor.openUrl\",e)}function J(e,t=\"info\"){return o(\"editor.flashNotification\",e,t)}function D(e,t,r=\"\",n=\"\"){return o(\"editor.filterBox\",e,t,r,n)}function Q(e,t,r,n=\"\"){return o(\"editor.showPanel\",e,t,r,n)}function U(e){return o(\"editor.hidePanel\",e)}function V(e,t){return o(\"editor.insertAtPos\",e,t)}function H(e,t,r){return o(\"editor.replaceRange\",e,t,r)}function W(e){return o(\"editor.moveCursor\",e)}function X(e){return o(\"editor.insertAtCursor\",e)}function Z(e){return o(\"editor.matchBefore\",e)}function _(e){return o(\"editor.dispatch\",e)}function ee(e,t=\"\"){return o(\"editor.prompt\",e,t)}function te(e){return o(\"editor.enableReadOnlyMode\",e)}var m={};p(m,{parseMarkdown:()=>re});function re(e){return o(\"markdown.parseMarkdown\",e)}var f={};p(f,{deleteAttachment:()=>ge,deletePage:()=>le,getAttachmentMeta:()=>fe,getPageMeta:()=>se,listAttachments:()=>me,listPages:()=>ie,listPlugs:()=>pe,readAttachment:()=>ue,readPage:()=>ae,writeAttachment:()=>de,writePage:()=>ce});function ie(e=!1){return o(\"space.listPages\",e)}function se(e){return o(\"space.getPageMeta\",e)}function ae(e){return o(\"space.readPage\",e)}function ce(e,t){return o(\"space.writePage\",e,t)}function le(e){return o(\"space.deletePage\",e)}function pe(){return o(\"space.listPlugs\")}function me(){return o(\"space.listAttachments\")}function fe(e){return o(\"space.getAttachmentMeta\",e)}function ue(e){return o(\"space.readAttachment\",e)}function de(e,t,r){return o(\"space.writeAttachment\",e,t,r)}function ge(e){return o(\"space.deleteAttachment\",e)}function g(e,t){if(t(e))return[e];let r=[];if(e.children)for(let n of e.children)r=[...r,...g(n,t)];return r}function P(e,t){return g(e,r=>r.type===t)[0]}function T(e,t){g(e,t)}var h=q(k(\"https://deno.land/std/encoding/yaml.ts\"));async function u(e,t=[\"yaml\"]){let r=await f.readPage(e),n=await m.parseMarkdown(r),i={};return T(n,a=>{if(a.type!==\"FencedCode\")return!1;let c=P(a,\"CodeInfo\");if(!c||!t.includes(c.children[0].text))return!1;let x=P(a,\"CodeText\");if(!x)return!1;let S=x.children[0].text;try{i=h.parse(S)}catch(y){throw console.error(\"YAML Page parser error\",y),new Error(`YAML Error: ${y.message}`)}return!0}),i}async function v(e){try{let t=await u(\"SECRETS\",[\"yaml\",\"secrets\"]),r=[];for(let n of e){let i=t[n];if(i)r.push(i);else throw new Error(`No such secret: ${n}`)}return r}catch(t){throw t.message===\"Page not found\"?new Error(`No such secret: ${e[0]}`):t}}var d=class{constructor(t){this.apiKey=t}async createCompletion(t){return(await fetch(\"https://api.openai.com/v1/completions\",{method:\"POST\",headers:{\"Content-Type\":\"application/json\",Authorization:`Bearer ${this.apiKey}`},body:JSON.stringify(t)})).json()}async createEdit(t){return(await fetch(\"https://api.openai.com/v1/edits\",{method:\"POST\",headers:{\"Content-Type\":\"application/json\",Authorization:`Bearer ${this.apiKey}`},body:JSON.stringify(t)})).json()}async createImage(t){return(await fetch(\"https://api.openai.com/v1/images/generations\",{method:\"POST\",headers:{\"Content-Type\":\"application/json\",Authorization:`Bearer ${this.apiKey}`},body:JSON.stringify(t)})).json()}async createModeration(t){return(await fetch(\"https://api.openai.com/v1/moderations\",{method:\"POST\",headers:{\"Content-Type\":\"application/json\",Authorization:`Bearer ${this.apiKey}`},body:JSON.stringify(t)})).json()}async getModels(){return(await fetch(\"https://api.openai.com/v1/models\",{method:\"GET\",headers:{\"Content-Type\":\"application/json\",Authorization:`Bearer ${this.apiKey}`}})).json()}};async function he(){try{let[e]=await v([\"openai\"]);return e}catch{console.error(\"No openai token found\"),s.flashNotification(\"SECRETS page missing, or OpenAI API token not configured correctly.\",\"error\")}}async function xe(){try{return await u(\"openai/settings\")}catch(e){return console.log(e),s.flashNotification(\"Settings page missing, or settings not configured correctly.\",\"error\"),[]}}async function C(){let e=await s.getText(),t=await s.getSelection(),r=e.slice(t.from,t.to),n=await xe();n.edit.prompt=r,console.log(n.edit);try{let i=await he(),a=new d(i);s.flashNotification(\"Generating edit...\",\"info\");let c=await a.createEdit(n.edit);s.insertAtPos(c.choices[0].text,t.to)}catch(i){console.log(i),s.flashNotification(\"Something went wrong\",\"error\")}s.flashNotification(\"Generation complete\",\"info\")}var ye=C;return E(we);})();\n return mod;})()"
    }
  },
  "assets": {}
}